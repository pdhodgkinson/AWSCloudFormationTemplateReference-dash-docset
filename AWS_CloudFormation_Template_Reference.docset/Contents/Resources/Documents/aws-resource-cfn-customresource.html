<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <h1 class="topictitle" id="aws-resource-cfn-customresource">AWS::CloudFormation::CustomResource</h1><p>In an AWS CloudFormation template, you use the <code class="code">AWS::CloudFormation::CustomResource</code> or <a href="aws-resource-cfn-customresource.html#aws-cfn-resource-type-name"><code class="code">Custom::<em class="replaceable"><code>String</code></em></code></a> resource type to specify custom resources.
                     </p><p>Custom resources provide a way for you to write custom provisioning logic in AWS CloudFormation
                        template
                        and have AWS CloudFormation run it during a stack operation, such as when you create,
                        update or delete a
                        stack. For more information, see <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html">Custom Resources</a>.
                     </p><div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>If you use the <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-endpoints.html" target="_blank">VPC endpoint</a>
                           feature, custom resources in the VPC must have access to AWS CloudFormation-specific
                           Amazon Simple Storage Service (Amazon S3)
                           buckets. Custom resources must send responses to a pre-signed Amazon S3 URL. If they
                           can&apos;t send
                           responses to Amazon S3, AWS CloudFormation won&apos;t receive a response and the stack
                           operation fails. For more
                           information, see <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-vpce-bucketnames.html">AWS CloudFormation and VPC Endpoints</a>.
                        </p>
                     </div><div class="highlights">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#aws-resource-cloudformation-customresource-syntax">Syntax</a></li>
                           <li><a href="#w2ab2c21c10d148c13">Properties</a></li>
                           <li><a href="#w2ab2c21c10d148c15">Return Values</a></li>
                           <li><a href="#w2ab2c21c10d148c17">Examples</a></li>
                           <li><a href="#w2ab2c21c10d148c19">Replacing a Custom Resource During an Update</a></li>
                        </ul>
                     </div><h2 id="aws-resource-cloudformation-customresource-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-resource-cloudformation-customresource-syntax.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight">
{
   &quot;Type&quot; : &quot;Custom::<em class="replaceable"><code>String</code></em>&quot;,
   &quot;Version&quot; : &quot;1.0&quot;,
   &quot;Properties&quot; : {
      &quot;<a href="aws-resource-cfn-customresource.html#cfn-customresource-servicetoken"><code class="literal">ServiceToken</code></a>&quot; : <em class="replaceable"><code>String</code></em>,
      <em class="replaceable"><code>... provider-defined properties ...</code></em>
   }
} </code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-resource-cloudformation-customresource-syntax.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight">Type: &quot;Custom::<em class="replaceable"><code>String</code></em>&quot;
Version: &quot;1.0&quot;
Properties:
  <a href="aws-resource-cfn-customresource.html#cfn-customresource-servicetoken"><code class="literal">ServiceToken</code></a>: <em class="replaceable"><code>String</code></em>
    <em class="replaceable"><code>... provider-defined properties ...</code></em>
</code></pre>
                        </div><h3 id="aws-cfn-resource-type-name">Custom::<em class="replaceable"><code>String</code></em></h3><p>For custom resources, you can specify
                        <code class="code">AWS::CloudFormation::CustomResource</code> as the resource type, or you can
                        specify your own resource type name. For example, instead of using
                        <code class="code">AWS::CloudFormation::CustomResource</code>, you can use
                        <code class="code">Custom::MyCustomResourceTypeName</code>.
                     </p><p>Custom resource type names can include alphanumeric characters and the following
                        characters: <code class="code">_@-</code>. You can specify a custom resource type name up to a
                        maximum length of 60 characters. You cannot change the type during an update.
                     </p><p>Using your own resource type names helps you quickly differentiate the types of
                        custom resources in your stack. For example, if you had two custom resources that
                        conduct two different ping tests, you could name their type as
                        <code class="code">Custom::PingTester</code> to make them easily identifiable as ping testers
                        (instead of using <code class="code">AWS::CloudFormation::CustomResource</code>).
                     </p><h2 id="w2ab2c21c10d148c13">Properties</h2><div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>Only one property is defined by AWS for a custom resource: <code class="code">ServiceToken</code>. All other properties are defined by the service provider.
                        </p>
                     </div><div class="variablelist">
                        
                        
                        <dl>
                           
                           <dt><a id="cfn-customresource-servicetoken"></a><span class="term"><code class="literal">ServiceToken</code></span></dt>
                           
                           <dd>
                              
                              <p>The service token that was given to the template developer by the service provider
                                 to access the service, such as an Amazon SNS topic ARN or Lambda function ARN. The
                                 service token must be from the same region in which you are creating the
                                 stack.
                              </p>
                              
                              <p><em>Required: </em>Yes
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: Updates are not supported.
                              </p>
                              
                           </dd>
                           
                        </dl>
                     </div><h2 id="w2ab2c21c10d148c15">Return Values</h2><p>For a custom resource, return values are defined by the custom resource provider,
                        and are retrieved by
                        calling <a href="intrinsic-function-reference-getatt.html"><code class="code">Fn::GetAtt</code></a>
                        on the provider-defined attributes.
                     </p><h2 id="w2ab2c21c10d148c17">Examples</h2><h3 id="w2ab2c21c10d148c17b2">Creating a custom resource definition in a template</h3><p>The following example demonstrates how to create a custom resource definition in a
                        template.
                     </p><p>All properties other than <code class="code">ServiceToken</code>, and all
                        <code class="code">Fn::GetAtt</code> resource attributes, are defined by
                        the custom resource provider.
                     </p><div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example2.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight ">{
   &quot;AWSTemplateFormatVersion&quot; : &quot;2010-09-09&quot;,
   &quot;Resources&quot; : {
      &quot;MyFrontEndTest&quot; : {
         &quot;Type&quot;: &quot;Custom::PingTester&quot;,
         &quot;Version&quot; : &quot;1.0&quot;,
         &quot;Properties&quot; : {
            &quot;ServiceToken&quot;: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;,
            &quot;key1&quot; : &quot;string&quot;,
            &quot;key2&quot; : [ &quot;list&quot; ],
            &quot;key3&quot; : { &quot;key4&quot; : &quot;map&quot; }
         }
      }
   },
   &quot;Outputs&quot; : {
      &quot;CustomResourceAttribute1&quot; : {
         &quot;Value&quot; : { &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey1&quot;] }
      },
      &quot;CustomResourceAttribute2&quot; : {
         &quot;Value&quot; : { &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey2&quot;] }
      }
   }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example2.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight ">AWSTemplateFormatVersion: &quot;2010-09-09&quot;
Resources: 
  MyFrontEndTest: 
    Type: &quot;Custom::PingTester&quot;
    Version: &quot;1.0&quot;
    Properties: 
      ServiceToken: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;
      key1: string
      key2: 
        - list
      key3: 
        key4: map
Outputs: 
  CustomResourceAttribute1: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey1
  CustomResourceAttribute2: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey2</code></pre>
                        </div><h3 id="w2ab2c21c10d148c17b4">Using an AWS Lambda function in a custom resource</h3><p>With Lambda functions and custom resources, you can run custom code in response to
                        stack events (create, update, and delete). The following custom resource invokes a
                        Lambda
                        function and sends it the <code class="code">StackName</code> property as input. The function uses
                        this property to get outputs from the appropriate stack.
                     </p><div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example3.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight ">&quot;MyCustomResource&quot; : {
  &quot;Type&quot; : &quot;Custom::TestLambdaCrossStackRef&quot;,
  &quot;Properties&quot; : {
    &quot;ServiceToken&quot;: { &quot;Fn::Join&quot;: [ &quot;&quot;, [ &quot;arn:aws:lambda:&quot;, { &quot;Ref&quot;: &quot;AWS::Region&quot; }, &quot;:&quot;, { &quot;Ref&quot;: &quot;AWS::AccountId&quot; }, &quot;:function:&quot;, {&quot;Ref&quot; : &quot;LambdaFunctionName&quot;} ] ] },
    &quot;StackName&quot;: {
      &quot;Ref&quot;: &quot;NetworkStackName&quot;
    }
  }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-cloudformation-customresource-example3.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight ">MyCustomResource: 
  Type: &quot;Custom::TestLambdaCrossStackRef&quot;
  Properties: 
    ServiceToken:
      !Sub |
        arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${LambdaFunctionName}
    StackName: 
      Ref: &quot;NetworkStackName&quot;</code></pre>
                        </div><h2 id="w2ab2c21c10d148c19">Replacing a Custom Resource During an Update</h2><p>You can update custom resources that require a replacement of the underlying physical
                        resource. When you update a custom resource in an AWS CloudFormation template, AWS
                        CloudFormation sends an update
                        request to that custom resource. If the custom resource requires a replacement, the
                        new
                        custom resource must send a response with the new physical ID. When AWS CloudFormation
                        receives the
                        response, it compares the <code class="code">PhysicalResourceId</code> between the old and new custom
                        resources. If they are different, AWS CloudFormation recognizes the update as a replacement
                        and sends a
                        delete request to the old resource. For a step-by-step walkthrough of this process,
                        see
                        <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources-sns.html#crpg-walkthrough-stack-updates">Stack Updates</a>. 
                     </p><p>Note the following: </p><div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>You can monitor the progress of the update in the <b>Events</b> tab.
                                 For more information, see <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-view-stack-data-resources.html">Viewing Stack Data and Resources</a>.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>For more information about resource behavior during updates, see <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html">AWS CloudFormation Stacks Updates</a>.
                              </p>
                              
                           </li>
                        </ul>
                     </div></div>
</body>
</html>