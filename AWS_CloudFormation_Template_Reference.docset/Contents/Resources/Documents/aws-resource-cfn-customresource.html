<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <h1 class="topictitle" id="aws-resource-cfn-customresource">AWS::CloudFormation::CustomResource</h1><p>In a CloudFormation template, you use the <code class="code">AWS::CloudFormation::CustomResource</code> or <code class="code">Custom::<em>String</em>
                           </code> resource type to specify custom resources.
                     </p><p>Custom resources provide a way for you to write custom provisioning logic in CloudFormation
                        template
                        and have CloudFormation run it during a stack operation, such as when you create,
                        update or delete a
                        stack. For more information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-custom-resources.html">Custom Resources</a>.
                     </p><div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>If you use the <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html">VPC Endpoints</a> feature, custom resources in the VPC must have access to CloudFormation-specific
                           Amazon Simple Storage Service (Amazon S3) 
                           buckets. Custom resources must send responses to a pre-signed Amazon S3 URL. If they
                           can&apos;t send
                           responses to Amazon S3, CloudFormation won&apos;t receive a response and the stack operation
                           fails. For more
                           information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-vpce-bucketnames.html">Setting Up VPC Endpoints for AWS CloudFormation</a>.
                        </p>
                     </div><h2 id="aws-resource-cfn-customresource-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-resource-cfn-customresource-syntax.json">JSON</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
  &quot;Type&quot; : &quot;AWS::CloudFormation::CustomResource&quot;,
  &quot;Properties&quot; : {
      &quot;<a href="#cfn-customresource-servicetoken">ServiceToken</a>&quot; : <em class="replaceable"><code>String</code></em>
    }
}
</code></pre></div><div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-resource-cfn-customresource-syntax.yaml">YAML</h3><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml ">Type: AWS::CloudFormation::CustomResource
Properties: 
  <a href="#cfn-customresource-servicetoken">ServiceToken</a>: <em class="replaceable"><code>String</code></em>
</code></pre></div><h2 id="aws-resource-cfn-customresource-properties">Properties</h2><div class="variablelist">
                        <dl>
                           <dt><a id="cfn-customresource-servicetoken"></a><span class="term"><code class="code">ServiceToken</code></span></dt>
                           <dd>
                              
                              <div class="aws-note">
                                 <p class="aws-note">Note</p>
                                 <p>Only one property is defined by AWS for a custom resource: <code class="code">ServiceToken</code>. All other properties are defined by the service provider.
                                 </p>
                              </div>
                              
                              <p>The service token that was given to the template developer by the service provider
                                 to access the service, such as an Amazon SNS topic ARN or Lambda function ARN. The
                                 service token must be from the same region in which you are creating the stack.
                              </p>
                              
                              <p>Updates are not supported.</p>
                              
                              
                              <p><em>Required</em>: Yes
                              </p>
                              <p><em>Type</em>: String
                              </p>
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                           </dd>
                        </dl>
                     </div><h2 id="aws-resource-cfn-customresource--remarks">Remarks</h2><p>
                        <em>Specifying Custom Resource Type Names</em>
                        
                     </p><p>For custom resources, you can specify
                        <code class="code">AWS::CloudFormation::CustomResource</code> as the resource type, or you can
                        specify your own resource type name. For example, instead of using
                        <code class="code">AWS::CloudFormation::CustomResource</code>, you can use
                        <code class="code">Custom::MyCustomResourceTypeName</code>.
                     </p><p>Custom resource type names can include alphanumeric characters and the following
                        characters: <code class="code">_@-</code>. You can specify a custom resource type name up to a
                        maximum length of 60 characters. You cannot change the type during an update.
                     </p><p>Using your own resource type names helps you quickly differentiate the types of
                        custom resources in your stack. For example, if you had two custom resources that
                        conduct two different ping tests, you could name their type as
                        <code class="code">Custom::PingTester</code> to make them easily identifiable as ping testers
                        (instead of using <code class="code">AWS::CloudFormation::CustomResource</code>).
                     </p><p>
                        <em>Replacing a Custom Resource During an Update</em>
                        
                     </p><p>You can update custom resources that require a replacement of the underlying physical
                        resource. When you update a custom resource in a CloudFormation template, CloudFormation
                        sends an update
                        request to that custom resource. If the custom resource requires a replacement, the
                        new
                        custom resource must send a response with the new physical ID. When CloudFormation
                        receives the
                        response, it compares the <code class="code">PhysicalResourceId</code> between the old and new custom
                        resources. If they are different, CloudFormation recognizes the update as a replacement
                        and sends a
                        delete request to the old resource. For a step-by-step walkthrough of this process,
                        see
                        <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/crpg-walkthrough-stack-updates.html">Stack Updates</a>. 
                     </p><p>Note the following: </p><div class="itemizedlist">
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>You can monitor the progress of the update in the Events tab. For more information,
                                 see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-view-stack-data-resources.html">Viewing Stack Data and Resources</a>.
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>For more information about resource behavior during updates, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks.html">AWS CloudFormation Stacks Updates</a>.
                              </p>
                              
                           </li>
                        </ul>
                     </div><p>
                        <em>Retrieving Return Values</em>
                        
                     </p><p>For a custom resource, return values are defined by the custom resource provider,
                        and are retrieved by calling Fn::GetAtt on the provider-defined attributes.
                     </p><h2 id="aws-resource-cfn-customresource--examples">Examples</h2><h3 id="aws-resource-cfn-customresource--examples--Creating_a_Custom_Resource_Definition_in_a_Template">Creating a Custom Resource Definition in a Template</h3><p>The following example demonstrates how to create a custom resource definition in a
                        template.
                     </p><p>All properties other than <code class="code">ServiceToken</code>, and all
                        <code class="code">Fn::GetAtt</code> resource attributes, are defined by
                        the custom resource provider.
                     </p><h4 id="aws-resource-cfn-customresource--examples--Creating_a_Custom_Resource_Definition_in_a_Template--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
  &quot;AWSTemplateFormatVersion&quot; : &quot;2010-09-09&quot;,
  &quot;Resources&quot; : {
    &quot;MyFrontEndTest&quot; : {
      &quot;Type&quot;: &quot;Custom::PingTester&quot;,
      &quot;Version&quot; : &quot;1.0&quot;,
      &quot;Properties&quot; : {
        &quot;ServiceToken&quot;: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;,
        &quot;key1&quot; : &quot;string&quot;,
        &quot;key2&quot; : [ &quot;list&quot; ],
        &quot;key3&quot; : { &quot;key4&quot; : &quot;map&quot; }
      }
    }
  },
  &quot;Outputs&quot; : {
    &quot;CustomResourceAttribute1&quot; : {
      &quot;Value&quot; : { &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey1&quot;] }
    },
    &quot;CustomResourceAttribute2&quot; : {
      &quot;Value&quot; : { &quot;Fn::GetAtt&quot; : [&quot;MyFrontEndTest&quot;, &quot;responseKey2&quot;] }
    }
  }
}</code></pre><h4 id="aws-resource-cfn-customresource--examples--Creating_a_Custom_Resource_Definition_in_a_Template--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml ">AWSTemplateFormatVersion: &quot;2010-09-09&quot;
Resources: 
  MyFrontEndTest: 
    Type: &quot;Custom::PingTester&quot;
    Version: &quot;1.0&quot;
    Properties: 
      ServiceToken: &quot;arn:aws:sns:us-east-1:84969EXAMPLE:CRTest&quot;
      key1: string
      key2: 
        - list
      key3: 
        key4: map
Outputs: 
  CustomResourceAttribute1: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey1
  CustomResourceAttribute2: 
    Value: 
      Fn::GetAtt: 
        - MyFrontEndTest
        - responseKey2</code></pre><h3 id="aws-resource-cfn-customresource--examples--Using_an_AWS_Lambda_Function_in_a_Custom_Resource">Using an AWS Lambda Function in a Custom Resource</h3><p>With Lambda functions and custom resources, you can run custom code in response to
                        stack events (create, update, and delete). The following custom resource invokes a
                        Lambda function and sends it the StackName property as input. The function uses this
                        property to get outputs from the appropriate stack.
                     </p><h4 id="aws-resource-cfn-customresource--examples--Using_an_AWS_Lambda_Function_in_a_Custom_Resource--json">JSON</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">&quot;MyCustomResource&quot; : {
  &quot;Type&quot; : &quot;Custom::TestLambdaCrossStackRef&quot;,
  &quot;Properties&quot; : {
    &quot;ServiceToken&quot;: { &quot;Fn::Join&quot;: [ &quot;&quot;, [ &quot;arn:aws:lambda:&quot;, { &quot;Ref&quot;: &quot;AWS::Region&quot; }, &quot;:&quot;, { &quot;Ref&quot;: &quot;AWS::AccountId&quot; }, &quot;:function:&quot;, {&quot;Ref&quot; : &quot;LambdaFunctionName&quot;} ] ] },
    &quot;StackName&quot;: {
      &quot;Ref&quot;: &quot;NetworkStackName&quot;
    }
  }
}</code></pre><h4 id="aws-resource-cfn-customresource--examples--Using_an_AWS_Lambda_Function_in_a_Custom_Resource--yaml">YAML</h4><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="yaml ">MyCustomResource: 
  Type: &quot;Custom::TestLambdaCrossStackRef&quot;
  Properties: 
    ServiceToken:
      !Sub arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${LambdaFunctionName}
    StackName: 
      Ref: &quot;NetworkStackName&quot;</code></pre><div id="marketing-target"><span class="close-button"></span><div class="marketing-title" id="marketing-title"></div>
                        <div class="marketing-description"><span id="marketing-description"></span><span id="marketing-cta"></span></div>
                     </div></div>
</body>
</html>