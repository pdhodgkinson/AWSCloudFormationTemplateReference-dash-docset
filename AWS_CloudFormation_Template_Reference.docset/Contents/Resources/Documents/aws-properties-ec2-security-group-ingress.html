<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <h1 class="topictitle" id="aws-properties-ec2-security-group-ingress">AWS::EC2::SecurityGroupIngress</h1><p>The <code class="code">AWS::EC2::SecurityGroupIngress</code> resource adds an ingress rule to an Amazon EC2
                        or Amazon VPC security group.
                     </p><div class="aws-note">
                        <p class="aws-note">Important</p>
                        <p>Use <code class="code">AWS::EC2::SecurityGroupIngress</code> and
                           <code class="code">AWS::EC2::SecurityGroupEgress</code> only when necessary, typically to allow
                           security groups to reference each other in ingress and egress rules. Otherwise, use
                           the
                           embedded ingress and egress rules of <a href="aws-properties-ec2-security-group.html">AWS::EC2::SecurityGroup</a>. For more information, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html">Amazon EC2 Security
                              Groups</a>.
                        </p>
                     </div><div class="highlights" id="inline-topiclist">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#aws-resource-ec2-securitygroupingress-syntax">Syntax</a></li>
                           <li><a href="#w2ab1c21c10d111d114c11">Properties</a></li>
                           <li><a href="#aws-properties-ec2-security-group-ingress-examples">Examples</a></li>
                        </ul>
                     </div><h2 id="aws-resource-ec2-securitygroupingress-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-resource-ec2-securitygroupingress-syntax.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">{
  &quot;Type&quot; : &quot;AWS::EC2::SecurityGroupIngress&quot;,
  &quot;Properties&quot; : {
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidrip">CidrIp</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidripv6">CidrIpv6</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-description">Description</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-fromport">FromPort</a>&quot; : <em class="replaceable"><code>Integer</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupid">GroupId</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupname">GroupName</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-ipprotocol">IpProtocol</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourceprefixlistid">SourcePrefixListId</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupname">SourceSecurityGroupName</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupid">SourceSecurityGroupId</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupownerid">SourceSecurityGroupOwnerId</a>&quot; : <em class="replaceable"><code>String</code></em>,
    &quot;<a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-toport">ToPort</a>&quot; : <em class="replaceable"><code>Integer</code></em>
  }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-resource-ec2-securitygroupingress-syntax.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">
Type: AWS::EC2::SecurityGroupIngress
Properties: 
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidrip">CidrIp</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-cidripv6">CidrIpv6</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-description">Description</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-fromport">FromPort</a>: <em class="replaceable"><code>Integer</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupid">GroupId</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-groupname">GroupName</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-ipprotocol">IpProtocol</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourceprefixlistid">SourcePrefixListId</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupname">SourceSecurityGroupName</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupid">SourceSecurityGroupId</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-sourcesecuritygroupownerid">SourceSecurityGroupOwnerId</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-security-group-ingress.html#cfn-ec2-security-group-ingress-toport">ToPort</a>: <em class="replaceable"><code>Integer</code></em>
</code></pre>
                        </div><h2 id="w2ab1c21c10d111d114c11">Properties</h2><p>For more information about adding ingress rules to Amazon EC2 or VPC security groups,
                        see
                        <a href="http://docs.aws.amazon.com/AWSEC2/latest/APIReference/ApiReference-query-AuthorizeSecurityGroupIngress.html">AuthorizeSecurityGroupIngress</a> in the <em>Amazon EC2 API Reference</em>.
                     </p><div class="aws-note">
                        <p class="aws-note">Note</p>
                        <p>If you change this resource&apos;s logical ID, you must also update a property value in
                           order to trigger an update for this resource.
                        </p>
                     </div><div class="variablelist">
                        
                        
                        
                        
                        
                        
                        
                         
                        
                        
                        
                        
                        
                        <dl>
                           
                           <dt><a id="cfn-ec2-security-group-ingress-cidrip"></a><span class="term"><code class="literal">CidrIp</code></span></dt>
                           
                           <dd>
                              
                              <p>An IPv4 CIDR range.</p>
                              
                              <p>For an overview of CIDR ranges, go to the <a href="http://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing" target="_blank">Wikipedia
                                    Tutorial</a>.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourceSecurityGroupName</code> or <code class="code">SourceSecurityGroupId</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-cidripv6"></a><span class="term"><code class="code">CidrIpv6</code></span></dt>
                           
                           <dd>
                              
                              <p>An IPv6 CIDR range.</p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourceSecurityGroupName</code> or <code class="code">SourceSecurityGroupId</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-description"></a><span class="term"><code class="literal">Description</code></span></dt>
                           
                           <dd>
                              
                              <p>Description of the ingress rule.</p>
                              
                              <p><em>Required</em>: No
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: 
                                 <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-fromport"></a><span class="term"><code class="literal">FromPort</code></span></dt>
                           
                           <dd>
                              
                              <p>Start of port range for the TCP and UDP protocols, or an ICMP type number.
                                 If you specify <code class="code">icmp</code> for the <code class="code">IpProtocol</code> property, you can
                                 specify -1 as a wildcard (i.e., any ICMP type number).
                              </p>
                              
                              <p><em>Type</em>: Integer
                              </p>
                              
                              <p><em>Required</em>: Yes, for ICMP and any protocol that uses ports.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-groupid"></a><span class="term"><code class="literal">GroupId</code></span></dt>
                           
                           <dd>
                              
                              <p>ID of the Amazon EC2 or VPC security group to modify. The group must belong to your
                                 account.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify the <code class="code">GroupName</code>
                                 property or the <code class="code">GroupId</code> property. For security groups that
                                 are in a VPC, you must use the <code class="code">GroupId</code> property. For example,
                                 <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-supported-platforms.html">EC2-VPC</a>
                                 accounts must use the <code class="code">GroupId</code> property.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-groupname"></a><span class="term"><code class="literal">GroupName</code></span></dt>
                           
                           <dd>
                              
                              <p>Name of the Amazon EC2 security group (non-VPC security group) to modify. This value
                                 can be a reference to an <a href="aws-properties-ec2-security-group.html">AWS::EC2::SecurityGroup</a> resource or the name of an existing Amazon EC2
                                 security group.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify the <code class="code">GroupName</code>
                                 property or the <code class="code">GroupId</code> property. For security groups that
                                 are in a VPC, you must use the <code class="code">GroupId</code> property. For example,
                                 <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-supported-platforms.html">EC2-VPC</a>
                                 accounts must use the <code class="code">GroupId</code> property.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-ipprotocol"></a><span class="term"><code class="literal">IpProtocol</code></span></dt>
                           
                           <dd>
                              
                              <p>IP protocol name or number. For valid values, see the IpProtocol parameter
                                 in <a href="http://docs.aws.amazon.com/AWSEC2/latest/APIReference/ApiReference-query-AuthorizeSecurityGroupIngress.html">AuthorizeSecurityGroupIngress</a></p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Yes
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-sourceprefixlistid"></a><span class="term"><code class="literal">SourcePrefixListId</code></span></dt>
                           
                           <dd>
                              
                              <p>The AWS service prefix of an Amazon VPC endpoint. For more information, see <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints.html">VPC Endpoints</a> in the
                                 <em>Amazon VPC User Guide</em>.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourcePrefixListId</code>, <code class="code">SourceSecurityGroupId</code>, or <code class="code">SourceSecurityGroupName</code>) or a
                                 CIDR range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-sourcesecuritygroupid"></a><span class="term"><code class="literal">SourceSecurityGroupId</code></span></dt>
                           
                           <dd>
                              
                              <p>Specifies the ID of the source security group or uses the <code class="code">Ref</code>
                                 intrinsic function to refer to the logical ID of a security group defined in the
                                 same template.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourcePrefixListId</code>, <code class="code">SourceSecurityGroupId</code>, or <code class="code">SourceSecurityGroupName</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-sourcesecuritygroupname"></a><span class="term"><code class="literal">SourceSecurityGroupName</code></span></dt>
                           
                           <dd>
                              
                              <p>Specifies the name of the Amazon EC2 security group (non-VPC security group) to
                                 allow access or use the <code class="code">Ref</code> intrinsic function to refer to the logical ID
                                 of a security group defined in the same template. For instances in a VPC, specify
                                 the
                                 <code class="code">SourceSecurityGroupId</code> property.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. You must specify a source security group
                                 (<code class="code">SourcePrefixListId</code>, <code class="code">SourceSecurityGroupId</code>, or <code class="code">SourceSecurityGroupName</code>) or a CIDR
                                 range (<code class="code">CidrIp</code> or <code class="code">CidrIpv6</code>).
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-sourcesecuritygroupownerid"></a><span class="term"><code class="literal">SourceSecurityGroupOwnerId</code></span></dt>
                           
                           <dd>
                              
                              <p>Specifies the AWS Account ID of the owner of the Amazon EC2 security group
                                 specified in the <code class="code">SourceSecurityGroupName</code> property.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Required</em>: Conditional. If you specify
                                 <code class="code">SourceSecurityGroupName</code> and that security group is owned
                                 by a different account than the account creating the stack, you must specify the
                                 <code class="code">SourceSecurityGroupOwnerId</code>; otherwise, this property is
                                 optional.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-security-group-ingress-toport"></a><span class="term"><code class="literal">ToPort</code></span></dt>
                           
                           <dd>
                              
                              <p>End of port range for the TCP and UDP protocols, or an ICMP code. If you
                                 specify <code class="code">icmp</code> for the <code class="code">IpProtocol</code> property, you can
                                 specify -1 as a wildcard (i.e., any ICMP code).
                              </p>
                              
                              <p><em>Type</em>: Integer
                              </p>
                              
                              <p><em>Required</em>: Yes, for ICMP and any protocol that uses ports.
                              </p>
                              
                              <p><em>Update requires</em>: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a></p>
                              
                           </dd>
                           
                        </dl>
                     </div><h2 id="aws-properties-ec2-security-group-ingress-examples">Examples</h2><h3 id="w2ab1c21c10d111d114c13b2">EC2 Security Group and Ingress Rule</h3><p>To create an Amazon EC2 (non-VPC) security group and an ingress rule, use the <code class="code">SourceSecurityGroupName</code> property in the ingress rule.
                     </p><p>The following template snippet creates an EC2 security group with an ingress rule
                        that allows incoming traffic on port 80 from any other host in the security group.
                        The snippet uses the intrinsic function <a href="intrinsic-function-reference-ref.html">Ref</a> to specify the value for <code class="code">SourceSecurityGroupName</code>.
                     </p><div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-1.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
    &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
    &quot;Resources&quot;: {
        &quot;SGBase&quot;: {
            &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
            &quot;Properties&quot;: {
                &quot;GroupDescription&quot;: &quot;Base Security Group&quot;,
                &quot;SecurityGroupIngress&quot;: [
                    {
                        &quot;IpProtocol&quot;: &quot;tcp&quot;,
                        &quot;CidrIp&quot;: &quot;0.0.0.0/0&quot;,
                        &quot;FromPort&quot;: 22,
                        &quot;ToPort&quot;: 22
                    }
                ]
            }
        },
        &quot;SGBaseIngress&quot;: {
            &quot;Type&quot;: &quot;AWS::EC2::SecurityGroupIngress&quot;,
            &quot;Properties&quot;: {
                &quot;GroupName&quot;: {
                    &quot;Ref&quot;: &quot;SGBase&quot;
                },
                &quot;IpProtocol&quot;: &quot;tcp&quot;,
                &quot;FromPort&quot;: 80,
                &quot;ToPort&quot;: 80,
                &quot;SourceSecurityGroupId&quot;: {
                    &quot;Ref&quot;: &quot;SGBase&quot;
                }
            }
        }
    }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-1.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">AWSTemplateFormatVersion: 2010-09-09
Resources:
  SGBase:
    Type: &apos;AWS::EC2::SecurityGroup&apos;
    Properties:
      GroupDescription: Base Security Group
      SecurityGroupIngress:
        - IpProtocol: tcp
          CidrIp: 0.0.0.0/0
          FromPort: 22
          ToPort: 22
  SGBaseIngress:
    Type: &apos;AWS::EC2::SecurityGroupIngress&apos;
    Properties:
      GroupName: !Ref SGBase
      IpProtocol: tcp
      FromPort: 80
      ToPort: 80
      SourceSecurityGroupId: !Ref SGBase</code></pre>
                        </div><h3 id="w2ab1c21c10d111d114c13b4">VPC Security Groups with Egress and Ingress Rules</h3><p>In some cases, you might have an originating (source) security group to which you
                        want to add an outbound rule that allows traffic to a destination (target) security
                        group. The target security group also needs an inbound rule that allows traffic from
                        the source security group. Note that you cannot use the <code class="code">Ref</code> function to specify the outbound and inbound rules for each security group. Doing
                        so creates a circular dependency; you cannot have two resources that depend on
                        each other. Instead, use the egress and ingress resources to declare these outbound
                        and inbound rules, as shown in the following template snippet.
                     </p><div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-2.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
  &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
  &quot;Resources&quot;: {
    &quot;SourceSG&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot;: {
        &quot;VpcId&quot; : &quot;vpc-1a2b3c4d&quot;,
        &quot;GroupDescription&quot;: &quot;Sample source security group&quot;
      }
    },
    &quot;TargetSG&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot;: {
        &quot;VpcId&quot; : &quot;vpc-1a2b3c4d&quot;,
        &quot;GroupDescription&quot;: &quot;Sample target security group&quot;
      }
    },
    &quot;OutboundRule&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroupEgress&quot;,
      &quot;Properties&quot;:{
        &quot;IpProtocol&quot;: &quot;tcp&quot;,
        &quot;FromPort&quot;: 0,
        &quot;ToPort&quot;: 65535,
        &quot;DestinationSecurityGroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;TargetSG&quot;,
            &quot;GroupId&quot;
          ]
        },
        &quot;GroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;SourceSG&quot;,
            &quot;GroupId&quot;
          ]
        }
      }
    },
    &quot;InboundRule&quot;: {
      &quot;Type&quot;: &quot;AWS::EC2::SecurityGroupIngress&quot;,
      &quot;Properties&quot;:{
        &quot;IpProtocol&quot;: &quot;tcp&quot;,
        &quot;FromPort&quot;: 0,
        &quot;ToPort&quot;: 65535,
        &quot;SourceSecurityGroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;SourceSG&quot;,
            &quot;GroupId&quot;
          ]
        },
        &quot;GroupId&quot;: {
          &quot;Fn::GetAtt&quot;: [
            &quot;TargetSG&quot;,
            &quot;GroupId&quot;
          ]
        }
      }
    }
  }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-2.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">AWSTemplateFormatVersion: &apos;2010-09-09&apos;
Resources:
  SourceSG:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: vpc-1a2b3c4d
      GroupDescription: Sample source security group
  TargetSG:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: vpc-1a2b3c4d
      GroupDescription: Sample target security group
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId</code></pre>
                        </div><h3 id="w2ab1c21c10d111d114c13b6">Allow Traffic from a Security Group in a Peered VPC</h3><p>Like the previous example, the following example allows one-way traffic from an
                        originating (source) security group to a destination (target) security group. However,
                        in
                        this example the security groups are in peered VPCs across AWS accounts. You might
                        want to
                        allow cross-account traffic if, for example, you create a security scanning resource
                        in one
                        AWS account that you&apos;ll use to run diagnostics in another account. This example adds
                        an
                        ingress rule to a target VPC security group that allows incoming traffic from a source
                        security group in a different AWS account. Note that the source security group also
                        needs an
                        egress rule that allows outgoing traffic to the target security group. Because the
                        source
                        security group is in a different account, the following example doesn&apos;t use the Ref
                        function
                        to reference the source security group ID but instead directly specifies the security
                        group
                        ID <code class="code">sg-12345678</code>. 
                     </p><div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-4.json">JSON</h4>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">{
    &quot;AWSTemplateFormatVersion&quot;: &quot;2010-09-09&quot;,
    &quot;Resources&quot;: {
        &quot;TargetSG&quot;: {
            &quot;Type&quot;: &quot;AWS::EC2::SecurityGroup&quot;,
            &quot;Properties&quot;: {
                &quot;VpcId&quot;: &quot;vpc-1a2b3c4d&quot;,
                &quot;GroupDescription&quot;: &quot;Security group allowing ingress for security scanners&quot;
            }
        },
        &quot;InboundRule&quot;: {
            &quot;Type&quot;: &quot;AWS::EC2::SecurityGroupIngress&quot;,
            &quot;Properties&quot;: {
                &quot;GroupId&quot;: {
                    &quot;Fn::GetAtt&quot;: [
                        &quot;TargetSG&quot;,
                        &quot;GroupId&quot;
                    ]
                },
                &quot;IpProtocol&quot;: &quot;tcp&quot;,
                &quot;FromPort&quot;: &quot;80&quot;,
                &quot;ToPort&quot;: &quot;80&quot;,
                &quot;SourceSecurityGroupId&quot;: &quot;sg-12345678&quot;,
                &quot;SourceSecurityGroupOwnerId&quot;: &quot;123456789012&quot;
            }
        }
    }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-4.yaml">YAML</h4>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">AWSTemplateFormatVersion: 2010-09-09
Resources:
  TargetSG:
    Type: &apos;AWS::EC2::SecurityGroup&apos;
    Properties:
      VpcId: vpc-1a2b3c4d
      GroupDescription: Security group allowing ingress for security scanners
  InboundRule:
    Type: &apos;AWS::EC2::SecurityGroupIngress&apos;
    Properties:
      GroupId: !GetAtt TargetSG.GroupId
      IpProtocol: tcp
      FromPort: &apos;80&apos;
      ToPort: &apos;80&apos;
      SourceSecurityGroupId: sg-12345678
      SourceSecurityGroupOwnerId: &apos;123456789012&apos;
</code></pre>
                        </div><h3 id="w2ab1c21c10d111d114c13b8">Allow Ping Requests</h3><p>To allow ping requests, add the ICMP protocol type and specify <code class="code">8</code> (echo request) for the ICMP type and either <code class="code">0</code> or <code class="code">-1</code> (all) for the ICMP code.
                     </p><div id="JSON" name="JSON" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-3.json">JSON</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">&quot;SGPing&quot; : {
  &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
  &quot;DependsOn&quot;: &quot;VPC&quot;,
  &quot;Properties&quot; : {
    &quot;GroupDescription&quot; : &quot;SG to test ping&quot;,
    &quot;VpcId&quot; : {&quot;Ref&quot; : &quot;VPC&quot;},
    &quot;SecurityGroupIngress&quot; : [ 
      { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : 22, &quot;ToPort&quot; : 22, &quot;CidrIp&quot; : &quot;10.0.0.0/24&quot; },
      { &quot;IpProtocol&quot; : &quot;icmp&quot;, &quot;FromPort&quot; : 8, &quot;ToPort&quot; : -1, &quot;CidrIp&quot; : &quot;10.0.0.0/24&quot; }
    ]
  }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h4 id="aws-resource-ec2-securitygroupingress-example-3.yaml">YAML</h4>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight ">SGPing:
  Type: AWS::EC2::SecurityGroup
  DependsOn: VPC
  Properties:
    GroupDescription: SG to test ping
    VpcId:
      Ref: VPC
    SecurityGroupIngress:
    - IpProtocol: tcp
      FromPort: 22
      ToPort: 22
      CidrIp: 10.0.0.0/24
    - IpProtocol: icmp
      FromPort: 8
      ToPort: -1
      CidrIp: 10.0.0.0/24</code></pre>
                        </div></div>
</body>
</html>