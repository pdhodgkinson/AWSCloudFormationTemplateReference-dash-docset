<!DOCTYPE html>
<html>
<head>
    <link href="css/awsdocs.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/awsdocs.min.js"></script>
    <meta charset="utf-8">
</head>
<body>
    <div id="content" style="padding: 10px 30px;">
    <h1 class="topictitle" id="aws-properties-ec2-eip-association">AWS::EC2::EIPAssociation</h1><p>The AWS::EC2::EIPAssociation resource type associates an Elastic IP address with an
                        Amazon EC2
                        instance. The Elastic IP address can be an existing Elastic IP address or an Elastic
                        IP
                        address allocated through an <a href="aws-properties-ec2-eip.html">AWS::EC2::EIP
                           resource</a>.
                     </p><p>For more information EC2-Classic and EC2-VPC, see <a href="http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_AssociateAddress.html" target="_blank">AssociateAddress</a> in the
                        <em>Amazon EC2 API Reference</em>.
                     </p><div class="highlights">
                        <p><strong>Topics</strong></p>
                        <ul>
                           <li><a href="#aws-resource-ec2-eipassociation-syntax">Syntax</a></li>
                           <li><a href="#aws-resource-ec2-eip-association-prop">Properties</a></li>
                           <li><a href="#w2ab2c21c10d352c13">Return Values</a></li>
                           <li><a href="#w2ab2c21c10d352c15">Examples</a></li>
                        </ul>
                     </div><h2 id="aws-resource-ec2-eipassociation-syntax">Syntax</h2><p>To declare this entity in your AWS CloudFormation template, use the following syntax:</p><div id="JSON" name="JSON" class="section langfilter">
                        <h3 id="aws-resource-ec2-eipassociation-syntax.json">JSON</h3>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight">
{
   &quot;Type&quot;: &quot;AWS::EC2::EIPAssociation&quot;,
   &quot;Properties&quot;: {
      &quot;<a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-allocationid">AllocationId</a>&quot;: <em class="replaceable"><code>String</code></em>,
      &quot;<a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-eip">EIP</a>&quot;: <em class="replaceable"><code>String</code></em>,
      &quot;<a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-instanceid">InstanceId</a>&quot;: <em class="replaceable"><code>String</code></em>,
      &quot;<a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-networkinterfaceid">NetworkInterfaceId</a>&quot;: <em class="replaceable"><code>String</code></em>,
      &quot;<a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-PrivateIpAddress">PrivateIpAddress</a>&quot;: <em class="replaceable"><code>String</code></em>
   }
}</code></pre>
                        </div><div id="YAML" name="YAML" class="section langfilter">
                        <h3 id="aws-resource-ec2-eipassociation-syntax.yaml">YAML</h3>
                        
                        <pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight">
Type: &quot;AWS::EC2::EIPAssociation&quot;
Properties:
  <a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-allocationid">AllocationId</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-eip">EIP</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-instanceid">InstanceId</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-networkinterfaceid">NetworkInterfaceId</a>: <em class="replaceable"><code>String</code></em>
  <a href="aws-properties-ec2-eip-association.html#cfn-ec2-eipassociation-PrivateIpAddress">PrivateIpAddress</a>: <em class="replaceable"><code>String</code></em>
</code></pre>
                        </div><h2 id="aws-resource-ec2-eip-association-prop">Properties</h2><div class="variablelist">
                        
                        
                        
                        
                        
                        
                        <dl>
                           
                           <dt><a id="cfn-ec2-eipassociation-allocationid"></a><span class="term"><code class="code">AllocationId</code></span></dt>
                           
                           <dd>
                              
                              <p>[EC2-VPC] Allocation ID for the VPC Elastic IP address you want to associate
                                 with an Amazon EC2 instance in your VPC.
                              </p>
                              
                              <p><em>Required</em>: Conditional. Required for  EC2-VPC.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a> if you also change the <code class="code">InstanceId</code> or
                                 <code class="code">NetworkInterfaceId</code> property. If not, update requires <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a>.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-eipassociation-eip"></a><span class="term"><code class="code">EIP</code></span></dt>
                           
                           <dd>
                              
                              <p>Elastic IP address that you want to associate with the Amazon EC2 instance specified
                                 by the <code class="code">InstanceId</code> property. You can specify an existing Elastic IP
                                 address or a reference to an Elastic IP address allocated with a <a href="aws-properties-ec2-eip.html">AWS::EC2::EIP resource</a>.
                              </p>
                              
                              <p><em>Required</em>: Conditional. Required for EC2-Classic.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a> if you also change the <code class="code">InstanceId</code> or
                                 <code class="code">NetworkInterfaceId</code> property. If not, update requires <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a>.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-eipassociation-instanceid"></a><span class="term"><code class="code">InstanceId</code></span></dt>
                           
                           <dd>
                              
                              <p>Instance ID of the Amazon EC2 instance that you want to associate with the Elastic
                                 IP address specified by the EIP property. If the instance has more than one network
                                 interface, you must specify a network interface ID.
                              </p>
                              
                              <p><em>Required</em>: Conditional. If you specify the <code class="code">EIP</code>
                                 property, you must specify this property. If you specify the <code class="code">AllocationId</code>
                                 property, you must specify this property or the <code class="code">NetworkInterfaceId</code>
                                 property.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a> if you also change the <code class="code">AllocationId</code> or
                                 <code class="code">EIP</code> property. If not, update requires <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a>.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-eipassociation-networkinterfaceid"></a><span class="term"><code class="code">NetworkInterfaceId</code></span></dt>
                           
                           <dd>
                              
                              <p>[EC2-VPC] The ID of the network interface to associate with the Elastic IP
                                 address. If the instance has more than one network interface, you must specify a
                                 network interface ID.
                              </p>
                              
                              <p><em>Required</em>: Conditional. If you specify the
                                 <code class="code">AllocationId</code> property, you must specify this property or the
                                 <code class="code">InstanceId</code> property.
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement">Replacement</a> if you also change the <code class="code">AllocationId</code> or
                                 <code class="code">EIP</code> property. If not, update requires <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a>.
                              </p>
                              
                           </dd>
                           
                           
                           <dt><a id="cfn-ec2-eipassociation-PrivateIpAddress"></a><span class="term"><code class="code">PrivateIpAddress</code></span></dt>
                           
                           <dd>
                              
                              <p>[EC2-VPC] The private IP address that you want to associate with the Elastic IP
                                 address. The private IP address is restricted to the primary and secondary private
                                 IP addresses that are associated with the network interface. By default, the
                                 private IP address that is associated with the EIP is the primary private IP
                                 address of the network interface.
                              </p>
                              
                              <p><em>Required</em>: No
                              </p>
                              
                              <p><em>Type</em>: String
                              </p>
                              
                              <p><em>Update requires</em>: <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-no-interrupt">No interruption</a></p>
                              
                           </dd>
                           
                        </dl>
                     </div><h2 id="w2ab2c21c10d352c13">Return Values</h2><h3 id="w2ab2c21c10d352c13b2">Ref</h3><p>When the logical ID of this resource is provided to the <code class="code">Ref</code> intrinsic
                        function, <code class="code">Ref</code> returns the resource name.
                     </p><p>For more information about using the <code class="code">Ref</code> function, see <a href="intrinsic-function-reference-ref.html">Ref</a>.
                     </p><h2 id="w2ab2c21c10d352c15">Examples</h2><p>The following example creates an instance with two elastic network interfaces (ENI).
                        The
                        example assumes that you have an existing VPC.
                     </p><p>For additional examples, see <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-ec2.html#scenario-ec2-eip">Assigning an Amazon EC2 Elastic IP Using AWS::EC2::EIP
                           Snippet</a>.
                     </p><h3 id="w2ab2c21c10d352c15b6">JSON</h3><pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight ">  &quot;Resources&quot; : {
    &quot;ControlPortAddress&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIP&quot;,
      &quot;Properties&quot; : {
        &quot;Domain&quot; : &quot;vpc&quot;
      }
    },
    &quot;AssociateControlPort&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
      &quot;Properties&quot; : {
        &quot;AllocationId&quot; : { &quot;Fn::GetAtt&quot; : [ &quot;ControlPortAddress&quot;, &quot;AllocationId&quot; ]},
        &quot;NetworkInterfaceId&quot; : { &quot;Ref&quot; : &quot;controlXface&quot; }
      }
    },
    &quot;WebPortAddress&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIP&quot;,
      &quot;Properties&quot; : {
        &quot;Domain&quot; : &quot;vpc&quot;
      }
    },
    &quot;AssociateWebPort&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::EIPAssociation&quot;,
      &quot;Properties&quot; : {
        &quot;AllocationId&quot; : { &quot;Fn::GetAtt&quot; : [ &quot;WebPortAddress&quot;, &quot;AllocationId&quot; ]},
        &quot;NetworkInterfaceId&quot; : { &quot;Ref&quot; : &quot;webXface&quot; }
      }
    },
    &quot;SSHSecurityGroup&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot; : {
        &quot;VpcId&quot; : { &quot;Ref&quot; : &quot;VpcId&quot; },
        &quot;GroupDescription&quot; : &quot;Enable SSH access via port 22&quot;,
        &quot;SecurityGroupIngress&quot; : [ { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : &quot;22&quot;, &quot;ToPort&quot; : &quot;22&quot;, &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot; } ]
      }
    },
    &quot;WebSecurityGroup&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::SecurityGroup&quot;,
      &quot;Properties&quot; : {
        &quot;VpcId&quot; : { &quot;Ref&quot; : &quot;VpcId&quot; },
        &quot;GroupDescription&quot; : &quot;Enable HTTP access via user defined port&quot;,
        &quot;SecurityGroupIngress&quot; : [ { &quot;IpProtocol&quot; : &quot;tcp&quot;, &quot;FromPort&quot; : 80, &quot;ToPort&quot; : 80, &quot;CidrIp&quot; : &quot;0.0.0.0/0&quot; } ]
      }
    },
    &quot;controlXface&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::NetworkInterface&quot;,
      &quot;Properties&quot; : {
        &quot;SubnetId&quot; : { &quot;Ref&quot; : &quot;SubnetId&quot; },
        &quot;Description&quot; :&quot;Interface for control traffic such as SSH&quot;,
        &quot;GroupSet&quot; : [ {&quot;Ref&quot; : &quot;SSHSecurityGroup&quot;} ],
        &quot;SourceDestCheck&quot; : &quot;true&quot;,
        &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Network&quot;, &quot;Value&quot; : &quot;Control&quot;}]
      }
    },
   &quot;webXface&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::NetworkInterface&quot;,
      &quot;Properties&quot; : {
        &quot;SubnetId&quot; : { &quot;Ref&quot; : &quot;SubnetId&quot; },
        &quot;Description&quot; :&quot;Interface for web traffic&quot;,
        &quot;GroupSet&quot; : [ {&quot;Ref&quot; : &quot;WebSecurityGroup&quot;} ],
        &quot;SourceDestCheck&quot; : &quot;true&quot;,
        &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Network&quot;, &quot;Value&quot; : &quot;Web&quot;}]
      }
    },
    &quot;Ec2Instance&quot; : {
      &quot;Type&quot; : &quot;AWS::EC2::Instance&quot;,
      &quot;Properties&quot; : {
        &quot;ImageId&quot; : { &quot;Fn::FindInMap&quot; : [ &quot;RegionMap&quot;, { &quot;Ref&quot; : &quot;AWS::Region&quot; }, &quot;AMI&quot; ]},
        &quot;KeyName&quot; : { &quot;Ref&quot; : &quot;KeyName&quot; },
        &quot;NetworkInterfaces&quot; : [ { &quot;NetworkInterfaceId&quot; : {&quot;Ref&quot; : &quot;controlXface&quot;}, &quot;DeviceIndex&quot; : &quot;0&quot; },
								{ &quot;NetworkInterfaceId&quot; : {&quot;Ref&quot; : &quot;webXface&quot;}, &quot;DeviceIndex&quot; : &quot;1&quot; }],
        &quot;Tags&quot; : [ {&quot;Key&quot; : &quot;Role&quot;, &quot;Value&quot; : &quot;Test Instance&quot;}],
        &quot;UserData&quot; : {&quot;Fn::Base64&quot; : { &quot;Fn::Join&quot; : [&quot;&quot;,[
			&quot;#!/bin/bash -ex&quot;,&quot;\n&quot;,
            &quot;\n&quot;,&quot;yum install ec2-net-utils -y&quot;,&quot;\n&quot;,
			&quot;ec2ifup eth1&quot;,&quot;\n&quot;,
			&quot;service httpd start&quot;]]}
		}
	  }
    }
  }</code></pre><h3 id="w2ab2c21c10d352c15b8">YAML</h3><pre class="programlisting"><div class="btn-copy-code-container"><div class="btn btn-copy-code">Copy</div></div><code class="nohighlight ">Resources:
  ControlPortAddress:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  AssociateControlPort:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt ControlPortAddress.AllocationId
      NetworkInterfaceId: !Ref controlXface
  WebPortAddress:
    Type: AWS::EC2::EIP
    Properties:
      Domain: vpc
  AssociateWebPort:
    Type: AWS::EC2::EIPAssociation
    Properties:
      AllocationId: !GetAtt WebPortAddress.AllocationId
      NetworkInterfaceId: !Ref webXface
  SSHSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: !Ref VpcId
      GroupDescription: Enable SSH access via port 22
      SecurityGroupIngress:
      - CidrIp: 0.0.0.0/0
        FromPort: 22
        IpProtocol: tcp
        ToPort: 22
  WebSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: !Ref VpcId
      GroupDescription: Enable HTTP access via user defined port
      SecurityGroupIngress:
      - CidrIp: 0.0.0.0/0
        FromPort: 80
        IpProtocol: tcp
        ToPort: 80
  controlXface:
    Type: AWS::EC2::NetworkInterface
    Properties:
      SubnetId: !Ref SubnetId
      Description: Interface for controlling traffic such as SSH
      GroupSet: 
      - !Ref SSHSecurityGroup
      SourceDestCheck: true
      Tags:
        -
          Key: Network
          Value: Control
  webXface:
    Type: AWS::EC2::NetworkInterface
    Properties:
      SubnetId: !Ref SubnetId
      Description: Interface for controlling traffic such as SSH
      GroupSet: 
      - !Ref WebSecurityGroup
      SourceDestCheck: true
      Tags:
        -
          Key: Network
          Value: Web
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: !FindInMap [ RegionMap, !Ref &apos;AWS::Region&apos;, AMI ]
      KeyName: !Ref KeyName
      NetworkInterfaces:
        -
          NetworkInterfaceId: !Ref controlXface
          DeviceIndex: 0
        -
          NetworkInterfaceId: !Ref webXface
          DeviceIndex: 1
      Tags:
        -
          Key: Role
          Value: Test Instance
      UserData:
        Fn::Base64: !Sub |
          #!/bin/bash -xe
          yum install ec2-net-utils -y
          ec2ifup eth1
          service httpd start</code></pre></div>
</body>
</html>